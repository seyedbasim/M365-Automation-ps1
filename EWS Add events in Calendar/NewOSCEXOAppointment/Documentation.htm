<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"\@SimSun";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	font-weight:bold;}
h1.CxSpFirst
	{mso-style-link:"Heading 1 Char";
	margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	font-weight:bold;}
h1.CxSpMiddle
	{mso-style-link:"Heading 1 Char";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	font-weight:bold;}
h1.CxSpLast
	{mso-style-link:"Heading 1 Char";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	font-weight:bold;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:13.0pt;
	font-family:"Cambria","serif";
	font-weight:bold;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
pre
	{mso-style-link:"HTML Preformatted Char";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:normal;
	font-size:10.0pt;
	font-family:"Courier New";}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"Balloon Text Char";
	margin:0in;
	margin-bottom:.0001pt;
	line-height:normal;
	font-size:8.0pt;
	font-family:"Tahoma","sans-serif";}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:.5in;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Cambria","serif";
	font-weight:bold;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Cambria","serif";
	font-weight:bold;}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-link:"Balloon Text";
	font-family:"Tahoma","sans-serif";}
span.HTMLPreformattedChar
	{mso-style-name:"HTML Preformatted Char";
	mso-style-link:"HTML Preformatted";
	font-family:"Courier New";}
.MsoChpDefault
	{font-family:"Calibri","sans-serif";}
.MsoPapDefault
	{margin-bottom:10.0pt;
	line-height:115%;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US link=blue vlink=purple>

<div class=WordSection1>

<h2><span style='font-size:14.0pt;line-height:115%'>Create Appointments for
Multiple Users in Office 365 Exchange Online</span></h2>

<p class=MsoNormal style='margin-top:10.0pt;margin-right:0in;margin-bottom:
0in;margin-left:0in;margin-bottom:.0001pt'><b><span style='font-size:13.0pt;
line-height:115%;font-family:"Cambria","serif"'>Introduction</span></b></p>

<p class=MsoNormal>This script can create appointments for multiple users in
Office 365 Exchange Online. This script requires you to add proper permission
to the default Calendar folder before creating appointments by default. However,
this script also allows you to use Impersonation. Impersonation enables an
account on an Exchange server to perform actions by using the permissions that
are associated with another account.</p>

<p class=MsoNormal style='margin-top:10.0pt;margin-right:0in;margin-bottom:
0in;margin-left:0in;margin-bottom:.0001pt'><b><span style='font-size:13.0pt;
line-height:115%;font-family:"Cambria","serif"'>Scenario</span></b></p>

<p class=MsoNormal>This script can create appointments for multiple users in
Office 365 Exchange Online. Under most circumstances, you can send meeting
invitations to achieve this goal. But sometimes Office 365 administrators are
asked to create appointments with reminders for different kinds of events.
These kinds of events should not send invitations. So they need this script.  </p>

<p class=MsoNormal style='margin-top:10.0pt;margin-right:0in;margin-bottom:
0in;margin-left:0in;margin-bottom:.0001pt'><b><span style='font-size:13.0pt;
line-height:115%;font-family:"Cambria","serif"'>Prerequisite</span></b></p>

<p class=MsoNormal>This script requires Exchange Web Service Managed API 2.0.
Please download and install the package from <a
href="http://www.microsoft.com/en-us/download/details.aspx?id=35371">Microsoft
Download Center</a>. This script cannot work correctly without this package.</p>

<p class=MsoNormal style='margin-top:10.0pt;margin-right:0in;margin-bottom:
0in;margin-left:0in;margin-bottom:.0001pt'><b><span style='font-size:13.0pt;
line-height:115%;font-family:"Cambria","serif"'>Script</span></b></p>

<p class=MsoNormal>This script contains the following advanced functions: </p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>Connect-OSCEXOWebService</b></p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>New-OSCEXOAppointment</b></p>

<p class=MsoNormal>You can use this script in the following way.</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Open
Windows PowerShell.</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Run
<b>Import-Module</b> cmdlet to import this module file.<br>
<b>Import-Module <i>filepath</i>\<i>scriptname</i>.psm1</b></p>

<p class=MsoNormal>Here are some code snippets for your references.  </p>

<pre>- PowerShell code snippet -</pre><pre style='background:white'><span
style='color:black'>&nbsp;</span></pre><pre style='background:white'><span
style='color:darkgreen'>#Save appointment to the default Calendar folder</span></pre><pre
style='background:white'><span style='color:darkblue'>Try</span></pre><pre
style='background:white'><span style='color:black'>{</span></pre><pre
style='background:white'><span style='color:black'>    </span><span
style='color:darkblue'>if</span><span style='color:black'> (</span><span
style='color:orangered'>$UseImpersonation</span><span style='color:black'>) {</span></pre><pre
style='background:white'><span style='color:black'>        </span><span
style='color:orangered'>$impersonationUserId</span><span style='color:black'> </span><span
style='color:darkgray'>=</span><span style='color:black'> </span><span
style='color:blue'>New-Object</span><span style='color:black'> </span><span
style='color:blueviolet'>Microsoft.Exchange.WebServices.Data.ImpersonatedUserId</span><span
style='color:black'>(`</span></pre><pre style='background:white'><span
style='color:black'>                               </span><span
style='color:teal'>[Microsoft.Exchange.WebServices.Data.ConnectingIdType]</span><span
style='color:darkgray'>::</span><span style='color:black'>SmtpAddress</span><span
style='color:darkgray'>,</span><span style='color:black'>`</span></pre><pre
style='background:white'><span style='color:black'>                                </span><span
style='color:darkgray'>,</span><span style='color:orangered'>$userSMTPAddress</span><span
style='color:black'>)</span></pre><pre style='background:white'><span
style='color:black'>        </span><span style='color:orangered'>$exService</span><span
style='color:darkgray'>.</span><span style='color:black'>ImpersonatedUserId </span><span
style='color:darkgray'>=</span><span style='color:black'> </span><span
style='color:orangered'>$impersonationUserId</span></pre><pre style='background:
white'><span style='color:black'>        </span><span style='color:orangered'>$newAppointment</span><span
style='color:darkgray'>.</span><span style='color:black'>Save(</span><span
style='color:teal'>[Microsoft.Exchange.WebServices.Data.WellKnownFolderName]</span><span
style='color:darkgray'>::</span><span style='color:black'>Calendar</span><span
style='color:darkgray'>,</span><span style='color:black'>`</span></pre><pre
style='background:white'><span style='color:black'>                             </span><span
style='color:teal'>[Microsoft.Exchange.WebServices.Data.SendInvitationsMode]</span><span
style='color:darkgray'>::</span><span style='color:black'>SendToNone)</span></pre><pre
style='background:white'><span style='color:black'>&nbsp;</span></pre><pre
style='background:white'><span style='color:black'>        </span><span
style='color:darkgreen'>#Clear ImpersonationUserId</span></pre><pre
style='background:white'><span style='color:black'>        </span><span
style='color:orangered'>$exService</span><span style='color:darkgray'>.</span><span
style='color:black'>ImpersonatedUserId </span><span style='color:darkgray'>=</span><span
style='color:black'> </span><span style='color:orangered'>$null</span></pre><pre
style='background:white'><span style='color:black'>    } </span><span
style='color:darkblue'>else</span><span style='color:black'> {</span></pre><pre
style='background:white'><span style='color:black'>        </span><span
style='color:orangered'>$folderId</span><span style='color:black'> </span><span
style='color:darkgray'>=</span><span style='color:black'> </span><span
style='color:blue'>New-Object</span><span style='color:black'> </span><span
style='color:blueviolet'>Microsoft.Exchange.WebServices.Data.FolderId</span><span
style='color:black'>(`</span></pre><pre style='background:white'><span
style='color:black'>                   </span><span style='color:teal'>[Microsoft.Exchange.WebServices.Data.WellKnownFolderName]</span><span
style='color:darkgray'>::</span><span style='color:black'>Calendar</span><span
style='color:darkgray'>,</span><span style='color:black'>`</span></pre><pre
style='background:white'><span style='color:black'>                   </span><span
style='color:orangered'>$userSMTPAddress</span><span style='color:black'>)</span></pre><pre
style='background:white'><span style='color:black'>        </span><span
style='color:orangered'>$newAppointment</span><span style='color:darkgray'>.</span><span
style='color:black'>Save(</span><span style='color:orangered'>$folderId</span><span
style='color:darkgray'>,</span><span style='color:black'> </span><span
style='color:teal'>[Microsoft.Exchange.WebServices.Data.SendInvitationsMode]</span><span
style='color:darkgray'>::</span><span style='color:black'>SendToNone)</span></pre><pre
style='background:white'><span style='color:black'>    }</span></pre><pre
style='background:white'><span style='color:black'>}</span></pre><pre
style='background:white'><span style='color:darkblue'>Catch</span></pre><pre
style='background:white'><span style='color:black'>{</span></pre><pre
style='background:white'><span style='color:black'>    </span><span
style='color:orangered'>$PSCmdlet</span><span style='color:darkgray'>.</span><span
style='color:black'>WriteError(</span><span style='color:orangered'>$_</span><span
style='color:black'>)</span></pre><pre style='background:white'><span
style='color:black'>}</span></pre><pre>&nbsp;</pre><pre>- end -</pre>

<p class=MsoNormal>&nbsp;</p>

<h2>Delegate Access and Impersonation in Office 365 Exchange Online</h2>

<p class=MsoNormal>Delegates are account holders who are authorized to perform
actions for a primary account. For example, an administrative assistant can be
granted access to an executive's calendar to make appointments on the
executive's behalf. You can use Outlook Web App (OWA) or Add-MailboxFolderPermission
to add mailbox folder permission for multiple users. </p>

<p class=MsoNormal>For customers who use Hosted Email Plan and Plan E1, you can
use impersonation when creating appointments. Please refer to <a
href="http://msdn.microsoft.com/en-us/library/exchange/gg194012%28v=exchg.140%29.aspx">Working
with application impersonation in Exchange Online</a> for the details. After
that, please use a proper service account to establish the connection when
using <b>Connect-OSCEXOWebService</b>. Then you can use the UseImpersonation parameter
when using <b>New-OSCEXOAppointment </b>to create appointments.</p>

<h2>New-OSCEXOAppointment Syntax (Parameter Sets)</h2>

<p class=MsoNormal>Because you can create appointments with seven types of
recurrence by using <b>New-OSCEXOAppointment</b>, and some parameters are
shared in two or more syntax (parameter sets), you may find its a bit
difficult to choose multiple parameters for one recurrence. So its recommended
to use <b>Show-Command </b>that is available in Windows PowerShell V3 to get a
graphic view of parameter sets. You can download Windows PowerShell V3 from <a
href="http://www.microsoft.com/en-us/download/details.aspx?id=34595">Microsoft
Download Center</a>.</p>

<p class=MsoNormal><img border=0 width=576 height=315 id="Picture 5"
src="Documentation_files/image001.jpg"></p>

<h2>Examples</h2>

<p class=MsoNormal><b>Example 1</b>: How to display help about <b>New-OSCEXOAppointment</b>.<br>
To display help about this function, run this command.<br>
<b>Get-Help New-OSCEXOAppointment </b><b>-Full</b><br>
<img border=0 width=576 height=183 id="Picture 3"
src="Documentation_files/image002.jpg"> </p>

<p class=MsoNormal><b>Example 2</b>: How to initiate a connection to Office 365
Exchange Online.<br>
To initiate a connection to Office 365 Exchange Online, please run this
command. You must run this example before any other step.<br>
<b>Connect-OSCEXOWebService -Credential (Get-Credential
admin@domain01.onmicrosoft.com)</b><br>
<img border=0 width=576 height=96 id="Picture 1"
src="Documentation_files/image003.jpg"><b><br>
Note </b>The <b>Connect-OSCEXOWebService</b> function creates a new variable
called exService. This variable is in the global scope of the current Windows
PowerShell session. This variable is used by other functions in the script. If
you want to use impersonation when creating appointments, please use a proper
service account to establish the connection.</p>

<p class=MsoNormal><b>Example 3</b>: How to create an appointment in the default
Calendar for mailbox user John Doe (johnd).<br>
To create an appointment in the default Calendar for mailbox user John Doe
(johnd), please run this command. <br>
<b>New-OSCEXOAppointment -Identity johnd -Subject &quot;Company Event&quot;
-Location &quot;Meeting Room&quot; -Body &quot;Company Event&quot;</b><br>
<img border=0 width=576 height=71 id="Picture 11"
src="Documentation_files/image004.jpg"></p>

<p class=MsoNormal><b>Example 4</b>: How to create an appointment in the
default Calendar for mailbox user John Doe (johnd) by using impersonation.<br>
To create an appointment in the default Calendar for mailbox user John Doe
(johnd) by using impersonation, please run this command.<br>
<b>New-OSCEXOAppointment -Identity johnd -Subject &quot;Company Event&quot;
-Location &quot;Meeting Room&quot; -Body &quot;Company Event&quot;
-UseImpersonation</b><br>
<img border=0 width=576 height=222 id="Picture 13"
src="Documentation_files/image005.jpg"></p>

<p class=MsoNormal><b>Example 5</b>: How to create an all-day event in the
default Calendar folder for the mailbox users John Doe (johnd) and Jane Doe
(janed).<br>
To create an all-day event in the default Calendar folder for the mailbox users
John Doe (johnd) and Jane Doe (janed), please run this command.<br>
<b>&quot;johnd&quot;,&quot;janed&quot; | New-OSCEXOAppointment -Subject
&quot;Company Holiday&quot; -Body &quot;Company Holiday&quot; -AllDayEvent</b><br>
<img border=0 width=576 height=84 id="Picture 15"
src="Documentation_files/image006.jpg"></p>

<p class=MsoNormal><b>Example 6</b>: How to create a recurrence appointment in
the default Calendar for mailbox user John Doe (johnd).<br>
To a recurrence appointment in the default Calendar for mailbox user John Doe
(johnd), please run this command.<br>
<b>New-OSCEXOAppointment -Identity johnd -Subject &quot;Company Event&quot;
-DayOfTheWeek Friday -Interval 2 -RecurrenceRangeEndAfter 2</b><br>
<img border=0 width=576 height=263 id="Picture 17"
src="Documentation_files/image007.jpg"></p>

<h2>Additional Resources</h2>

<p class=MsoNormal><b>Technical Resources: <br>
</b><a href="http://technet.microsoft.com/en-us/library/dd315326.aspx">Windows
PowerShell Advanced Function</a><br>
<a href="http://msdn.microsoft.com/en-us/library/dd633661(v=exchg.80).aspx">Creating
appointments and meetings by using the EWS Managed API</a><span
class=MsoHyperlink><br>
</span><a
href="http://msdn.microsoft.com/en-us/library/dd633683(v=exchg.80).aspx">Working
with recurring calendar items by using the EWS Managed API</a><span
class=MsoHyperlink><br>
</span><br>
<b>Forum Threads: <br>
</b><a
href="http://community.office365.com/en-us/forums/158/p/80633/312803.aspx">http://community.office365.com/en-us/forums/158/p/80633/312803.aspx</a><br>
<a href="http://community.office365.com/en-us/forums/158/p/80441/312811.aspx">http://community.office365.com/en-us/forums/158/p/80441/312811.aspx</a></p>

</div>

</body>

</html>
